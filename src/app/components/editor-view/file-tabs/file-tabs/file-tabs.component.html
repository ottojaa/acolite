<p-contextMenu #cm appendTo="body" [model]="contextMenuItems"></p-contextMenu>

<div #tabContainer class="editor">
  <mat-tab-group
    animationDuration="0ms"
    [selectedIndex]="selectedTab$ | async"
    (selectedTabChange)="onSelectTab($event)"
  >
    <ng-container *ngFor="let tab of tabs; trackBy: trackByPath">
      <div class="editor">
        <mat-tab matRipple [matRippleColor]="'ffff'">
          <ng-template mat-tab-label>
            <div
              class="contextmenu-container"
              [ngClass]="tab.deleted ? 'deleted-tab-title' : ''"
              (contextmenu)="onRightClick($event, tab)"
            >
              <app-icon [extension]="tab.extension"></app-icon>
              <span class="tab-name">{{ tab.fileName }}</span>
              <mat-icon class="close-button" (click)="onCloseTab(tab.filePath)">close</mat-icon>
            </div>
          </ng-template>

          <ng-container *ngIf="tab.deleted; else showEditor">
            <div class="deleted">
              <h2 class="deleted-text">
                This file appears to be deleted! If this was a mistake, press
                <span aria-label="bring-deleted-file-back" class="bring-back" (click)="revertDelete(tab)">here</span>
                to bring it back
              </h2>
            </div>
          </ng-container>

          <ng-template #showEditor>
            <ng-container [ngSwitch]="tab.extension">
              <div *ngSwitchCase="'txt'" class="editor">
                <app-text-editor [tab]="tab"></app-text-editor>
              </div>

              <div *ngSwitchCase="'md'" class="editor">
                <app-markdown-editor [tab]="tab"></app-markdown-editor>
              </div>

              <div *ngSwitchCase="'json'" class="editor">
                <app-json-editor [tab]="tab"></app-json-editor>
              </div>

              <div *ngSwitchDefault>No editor for this type of file</div>
            </ng-container>
          </ng-template>
        </mat-tab>
      </div>
    </ng-container>
  </mat-tab-group>
</div>
